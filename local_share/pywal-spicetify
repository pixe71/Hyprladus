#!/usr/bin/env bash

# Wrapper to update Spicetify with Pywal colors
# Expects ~/.cache/wal/colors-spicetify.ini to be generated by wal

TEMPLATE="$HOME/.cache/wal/colors-spicetify.ini"
THEME_DIR="$HOME/.config/spicetify/Themes/Pywal"

if ! command -v spicetify &> /dev/null; then
    echo "Spicetify not found. Skipping."
    exit 0
fi

if [ ! -f "$TEMPLATE" ]; then
    echo "Pywal template for Spicetify not found at $TEMPLATE"
    exit 1
fi

# Create entry for Pywal theme if it doesn't exist
mkdir -p "$THEME_DIR"
cp "$TEMPLATE" "$THEME_DIR/color.ini"

# Ensure creating a minimal user.css if missing, or copy from a base theme if preferred
# For now, we assume color.ini is enough or the user sets it up
touch "$THEME_DIR/user.css"

# Apply
spicetify config current_theme Pywal
spicetify config color_scheme .
spicetify apply -n
